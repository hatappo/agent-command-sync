# Changelog

## [5.3.0] - 2026-02-28

### Added
- **`acs update [skill-path]` subcommand**: Check for and apply upstream updates to downloaded skills
  - Scans local skills with `_from` provenance and compares tree hashes against upstream repositories
  - Without arguments: scans all agent skill directories (`.claude/skills/`, `.gemini/skills/`, etc.)
  - With `skill-path`: scans the specified path for skills (single skill directory or parent directory containing multiple skills)
  - Supports `--noop` for dry-run mode (check only, no downloads)
  - Groups skills by `owner/repo` for efficient batched API calls
  - Handles truncated/short tree hashes gracefully (treated as mismatch, triggers re-download)
  - Legacy `_from` without tree hash (e.g., `owner/repo`) forces re-download and updates `_from` with current hash
- **Skill-level summary list in bulk download**: `acs download <repo-url>` now shows a per-skill summary at the end of output, making it easier to see which skills were created, updated, or unchanged

### Changed
- **Update status wording**: Changed "Up to date" to "No upstream changes" to accurately reflect that only the upstream state is checked, not local file identity

## [5.2.0] - 2026-02-27

### Added
- **`--no-provenance` option**: Skip `_from` provenance tracking in `download` and `sync` commands. Available on all subcommands (sync, import, drift, apply, plan, download).

### Changed
- **`_from` provenance format**: Shortened from full GitHub URL (e.g., `https://github.com/owner/repo/tree/main/.claude/skills/my-skill`) to `owner/repo` format
- **`_from` single-entry policy**: If `_from` already has an entry, no additional entry is added. Provenance chain A→B→C is traceable via one entry per node.

## [5.1.0] - 2026-02-27

### Added
- **Repository-level bulk download**: `acs download <repo-url>` scans the entire repository for skills (directories containing `SKILL.md`) and downloads them all at once
  - Supports bare repo URLs (`https://github.com/owner/repo`) and tree URLs (`https://github.com/owner/repo/tree/main`)
  - Uses GitHub Git Trees API for efficient repository scanning
  - Continues downloading remaining skills if one fails
  - Warns when the tree response is truncated by GitHub API
- **Skill-level summary**: Download and sync output now includes a skill-level summary line (e.g., `2 skills created, 1 skill updated`) in addition to the file-level summary

## [5.0.1] - 2026-02-27

### Fixed
- Improved Quick Start examples in README with concrete URLs and paths

## [5.0.0] - 2026-02-27

### BREAKING CHANGES
- **CLI positional arguments for `sync`**: Replaced `-s/--src` and `-d/--dest` options with positional `<from>` and `<to>` arguments
  - Before: `acs sync -s claude -d gemini`
  - After: `acs sync claude gemini`
- **CLI positional argument for `download`**: Replaced `-d/--dest` option with optional positional `[to]` argument
  - Before: `acs download <url> -d gemini`
  - After: `acs download <url> gemini`
- **Default content type changed**: `-t` default changed from `both` to `skills`. Use `-t both` or `-t commands` to include commands

## [4.2.0] - 2026-02-25

### Added
- **`_from` provenance tracking**: Commands and skills now record their origin in a `_from` frontmatter property (URL array)
  - **Sync**: Automatically appends the source repository's GitHub remote URL (e.g., `https://github.com/owner/repo`) when syncing from a Git repository with a GitHub remote
  - **Download**: Injects the download URL into `SKILL.md` frontmatter
  - Stored as `semantic.from` in SemanticIR (preserved across conversions, not removed by `--remove-unsupported`)
  - Supported by all agents (Cursor commands lose `_from` due to no frontmatter)
- `getGitHubRemoteUrl()` utility for detecting GitHub remote from `.git/config`

## [4.1.0] - 2026-02-25

### Added
- **`acs download <url>` subcommand**: Download skills directly from GitHub repositories
  - Fetches all files from a GitHub skill directory via the Contents API
  - Default: preserves URL path relative to project root (e.g., `.claude/skills/my-skill/`)
  - With `-d <agent>`: places files in the specified agent's skill directory
  - With `-g` (requires `-d`): uses user-level (global) directory
  - Supports `--noop` for dry run preview
  - Supports both `tree/` (directory) and `blob/` (file, auto-detects parent) GitHub URLs
  - Handles text and binary files
  - Uses `GITHUB_TOKEN` environment variable for authentication (optional)

## [4.0.0] - 2026-02-24

### BREAKING CHANGES
- **Project-level directories by default**: When running inside a Git repository, `acs` now uses project-level directories (e.g., `<repo>/.claude`, `<repo>/.gemini`) instead of user-level directories (e.g., `~/.claude`, `~/.gemini`). Use `-g`/`--global` to revert to user-level behavior.
- **`resolveCommandDir` / `resolveSkillDir` return type changed**: These functions now return a single `string` (resolved path) instead of `{ project, user }` object. Callers using `.user` property access must update.

### Added
- **`-g` / `--global` option**: Available on all subcommands (sync, import, drift, apply, plan, status). Forces user-level (global) directory resolution.
- **Git repository root detection**: Pure Node.js implementation that walks up from cwd to find `.git`. Supports normal repos, worktrees, and submodules.
- **Mode indicator in output**: Sync and status commands now display `[project: /path/to/repo]` or `[global]` to indicate which directory mode is active.

## [3.4.0] - 2026-02-23

### Added
- **`[=]` Unchanged indicator**: Commands and skills whose converted content is identical to the existing target are now reported as `[=]` (Blue) instead of `[M]`, with file writes skipped for unchanged files

### Fixed
- **Skill conversion: remove `_claude_` prefix pattern**: Skill fields are now passed through as-is (like commands), instead of being stored with `_claude_*` prefix in target frontmatter. Lossy conversion is handled by the Chimera hub. This simplifies the codebase and makes skill conversion consistent with command conversion.

## [3.2.0] - 2026-02-23

### Added
- **`acs version` subcommand**: Display the current version number

## [3.1.0] - 2026-02-23

### Added
- **`acs status` subcommand**: Show Chimera hub status with ASCII art evolution
  - Displays evolving Chimera ASCII art (Ghost at Lv.0 through 10 animal forms)
  - Shows detected agents, composition, and command/skill counts in a speech bubble
  - Scans Chimera hub `_chimera` frontmatter sections to detect synced agents

## [3.0.0] - 2026-02-22

### Breaking Changes
- **CLI subcommand architecture**: Replaced flat CLI options with subcommands
  - `acs sync -s <src> -d <dest>` for direct conversion
  - `acs import <agent>` shorthand for `acs sync -s <agent> -d chimera`
  - `acs drift <agent>` shorthand for `acs sync -s <agent> -d chimera -n`
  - `acs apply <agent>` shorthand for `acs sync -s chimera -d <agent>`
  - `acs plan <agent>` shorthand for `acs sync -s chimera -d <agent> -n`
- Noop messages now reflect the subcommand used (e.g., "Use `acs import` to apply changes" for `drift`)

### Added
- **Chimera Hub**: Lossless conversion hub that preserves all agent-specific settings in `_chimera` frontmatter sections
  - Import from any agent merges extras into per-agent namespaces
  - Apply to any agent restores agent-specific settings from stored extras
  - Supports both commands and skills
- **GitHub Copilot support**: Added as 5th agent format (`.prompt.md` with YAML frontmatter)
- **Cursor support**: Added as 6th agent format (plain Markdown, no frontmatter)
- Chimera hub workflow documentation (`docs/chimera-hub-workflow.md`)

### Changed
- **Agent Registry pattern**: Unified parser/converter into single agent class per agent
  - Replaced switch statements with type-safe registry lookup
  - Dynamic CLI option generation from registry
- Test suite expansion: 250 → 381 tests

## [2.2.1] - 2026-02-21

### Fixed
- Use absolute GitHub URLs for README images to fix npm display
- Add `--run` flag to vitest to prevent watch mode during publish

## [2.2.0] - 2026-02-21

### Added
- **Skills support**: Bidirectional conversion of Skills (directory-based prompts with `SKILL.md` + support files) between Claude Code, Gemini CLI, and Codex CLI
  - Support file handling (text and binary files copied as-is)
  - Codex `agents/openai.yaml` generation from Claude's `disable-model-invocation`
  - `--sync-delete` support for orphaned skill directories
- **Content type filtering**: New `-t, --type` option to convert `commands`, `skills`, or `both` (default: `both`)

### Changed
- **SemanticIR hub-and-spoke architecture**: Replaced 12 pairwise converters with 6 bidirectional `SemanticConverter` implementations
  - Body content tokenized as `BodySegment[]` for IR-level placeholder conversion
  - Type-driven `PlaceholderSerializers` registry with compile-time exhaustiveness checking
  - Claude/Codex shared body patterns extracted into common module
- **Test suite expansion**: 182 → 250 tests
  - Added Codex body parse/serialize tests, skill-utils tests, writeToDirectory tests
  - Added skill conversion and syncDelete integration tests
  - Added file search function tests
  - Removed meaningless placeholder test

### Fixed
- Shell command syntax in documentation corrected to `` !`command` ``
- Biome lint now correctly excludes coverage directory

## [2.1.0] - 2025-01-08

### Added
- **File reference conversion**: Added automatic conversion of file reference syntax between Claude Code (`@path/to/file`) and Gemini CLI (`@{path/to/file}`)
- **Individual argument placeholders documentation**: Documented support for `$1` through `$9` placeholders in Claude Code and Codex CLI

### Changed
- Improved README documentation with clearer format comparison tables
  - Separated into "File Structure and Metadata" and "Content Placeholders and Syntax" sections
  - Added detailed explanations for all placeholder types

### Fixed
- File reference patterns now correctly handle various file paths and extensions

## [2.0.0] - 2025-01-07

### Breaking Changes
- Renamed package from `agent-slash-sync` to `agent-command-sync`
- Renamed command from `assync` to `acsync`
- Changed `-d, --dry-run` option to `-n, --noop`
- Removed `-c, --convert` option; now use `-s, --src` and `-d, --dest` to specify source and destination
- Package URLs have changed:
  - npm: `https://www.npmjs.com/package/agent-slash-sync` → `https://www.npmjs.com/package/agent-command-sync`
  - GitHub: `https://github.com/hatappo/agent-slash-sync` → `https://github.com/hatappo/agent-command-sync`

### Added
- **Codex CLI support**: Added support for Codex CLI as a third tool format
  - Supports markdown with optional YAML frontmatter
  - Bidirectional conversion between Claude Code, Gemini CLI, and Codex CLI
  - Frontmatter preservation when `--remove-unsupported` is not specified
- **Intermediate Representation (IR) architecture**: Completely rewrote the conversion system
  - Centralized conversion logic through intermediate representation
  - Easier to add new tool formats in the future
  - More maintainable and testable codebase

### Changed
- Translated all inline comments from Japanese to English
- Improved error handling and validation throughout the codebase

### Dependencies
- Updated to latest versions of all dependencies

## [1.2.0] - Previous release
- Added support for custom base directories with `--claude-dir` and `--gemini-dir` options