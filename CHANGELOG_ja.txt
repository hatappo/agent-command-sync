# 変更履歴

## [5.6.0] - 2026-02-28

### 変更
- **`_from` プロバナンスの短縮 SHA 化**: `_from` の tree hash がデフォルトで 7 文字の短縮 SHA（例: `owner/repo@d5cd683`）に変更。`download` と `update` コマンドで `--full-hash` オプションを指定するとフル 40 文字 SHA を維持可能。既存のフル SHA は prefix マッチにより引き続き認識。

## [5.5.0] - 2026-02-28

### 追加機能
- **`acs info` のインタラクティブスキル選択**: 引数なしで実行すると全エージェントディレクトリのスキルを検出し、矢印キーで選択する UI を表示
  - スキル件数、番号付き選択肢（パス付き）、説明文を表示
  - `@inquirer/select` を使用した選択 UI
- **2段階ヘルプ表示（Cargo パターン）**: `acs -h` で簡潔表示、`acs --help` で詳細表示（Advanced Commands・Advanced Examples を含む）

### 変更
- **`acs info` の引数をオプショナル化**: `info <skill-path>` → `info [skill-path]`

## [5.4.0] - 2026-02-28

### 追加機能
- **`acs info <skill-path>` サブコマンド**: スキル情報とソースリンクを表示
  - メタ情報: 説明文、ソース（`_from`）、ライセンス、ローカルパス、Git remote URL
  - スキルディレクトリ内のファイル一覧（直下ファイル＋サブディレクトリとファイル数）
  - `_from` がある場合はソースリンク（GitHub, skillsmp.com, skills.sh）を表示
  - GitHub API でソースリポジトリ内のスキルパスを正確に解決
  - スキルディレクトリパスと `SKILL.md` ファイルパスの両方を受け付け
- **`getOriginRemoteUrl()` ユーティリティ**: `.git/config` から生の origin remote URL を取得（GitHub 正規化なし）

## [5.3.0] - 2026-02-28

### 追加機能
- **`acs update [skill-path]` サブコマンド**: ダウンロード済みスキルの上流更新をチェックし適用
  - `_from` プロバナンスを持つローカルスキルをスキャンし、上流リポジトリの tree hash と比較
  - 引数なし: 全エージェントスキルディレクトリ（`.claude/skills/`、`.gemini/skills/` 等）をスキャン
  - `skill-path` 指定: 指定パス配下のスキルをスキャン（単一スキルディレクトリまたは複数スキルを含む親ディレクトリ）
  - `--noop` でドライランモード（チェックのみ、ダウンロードなし）をサポート
  - `owner/repo` 単位でグループ化し効率的にバッチ API 呼び出し
  - 短縮・不正な tree hash もエラーにならずハッシュ不一致として処理（再ダウンロードをトリガー）
  - tree hash なしのレガシー `_from`（例: `owner/repo`）は強制再ダウンロードし、現在のハッシュで `_from` を更新
- **一括ダウンロード時のスキルレベルサマリー一覧**: `acs download <repo-url>` の出力末尾にスキルごとのサマリーを表示し、どのスキルが作成・更新・変更なしかを把握しやすく

### 変更
- **更新ステータスの表現変更**: 「Up to date」を「No upstream changes」に変更。上流の変更状態のみをチェックしていることを正確に反映（ローカルファイルの同一性は確認していない）
- **`dl` エイリアス**: `acs dl` を `acs download` の省略形として使用可能に

## [5.2.0] - 2026-02-27

### 追加機能
- **`--no-provenance` オプション**: `download` および `sync` コマンドで `_from` プロバナンス記録をスキップ。全サブコマンド（sync, import, drift, apply, plan, download）で利用可能。

### 変更
- **`_from` プロバナンス形式の短縮**: 完全な GitHub URL（例: `https://github.com/owner/repo/tree/main/.claude/skills/my-skill`）から `owner/repo` 形式に変更
- **`_from` 単一エントリポリシー**: 既に `_from` エントリが存在する場合、追加エントリは記録しない。プロバナンスチェーン A→B→C は各ノードの1エントリで追跡可能。

## [5.1.0] - 2026-02-27

### 追加機能
- **リポジトリレベル一括ダウンロード**: `acs download <repo-url>` でリポジトリ全体をスキャンし、スキル（`SKILL.md` を含むディレクトリ）を一括ダウンロード
  - ベアリポジトリ URL（`https://github.com/owner/repo`）およびツリー URL（`https://github.com/owner/repo/tree/main`）に対応
  - GitHub Git Trees API による効率的なリポジトリスキャン
  - 1つのスキルが失敗しても残りのダウンロードを継続
  - GitHub API によりツリーが切り詰められた場合に警告を表示
- **スキルレベルサマリー**: download および sync の出力にファイルレベルサマリーに加え、スキルレベルサマリー行（例: `2 skills created, 1 skill updated`）を表示

## [5.0.1] - 2026-02-27

### 修正
- README の Quick Start 例を具体的な URL・パスに改善

## [5.0.0] - 2026-02-27

### 破壊的変更
- **`sync` の CLI ポジショナル引数化**: `-s/--src` と `-d/--dest` オプションをポジショナル引数 `<from>` `<to>` に変更
  - 変更前: `acs sync -s claude -d gemini`
  - 変更後: `acs sync claude gemini`
- **`download` の CLI ポジショナル引数化**: `-d/--dest` オプションをオプショナルポジショナル引数 `[to]` に変更
  - 変更前: `acs download <url> -d gemini`
  - 変更後: `acs download <url> gemini`
- **デフォルトコンテンツタイプの変更**: `-t` のデフォルトを `both` から `skills` に変更。Commands を含めるには `-t both` または `-t commands` を指定

## [4.0.0] - 2026-02-24

### 破壊的変更
- **プロジェクトレベルディレクトリがデフォルト**: Git リポジトリ内で実行した場合、`acs` はユーザーレベルディレクトリ（`~/.claude` 等）ではなくプロジェクトレベルディレクトリ（`<repo>/.claude` 等）を使用。`-g`/`--global` で従来の動作に戻せる。
- **`resolveCommandDir` / `resolveSkillDir` の戻り値型変更**: `{ project, user }` オブジェクトから単一の `string`（解決済みパス）に変更。`.user` プロパティアクセスの更新が必要。

### 追加機能
- **`-g` / `--global` オプション**: 全サブコマンド（sync, import, drift, apply, plan, status）で利用可能。ユーザーレベル（グローバル）ディレクトリの使用を強制。
- **Git リポジトリルート自動検出**: cwd から上方向に `.git` を探索する純粋 Node.js 実装。通常のリポジトリ、worktree、submodule に対応。
- **モード表示**: sync および status コマンドの出力に `[project: /path/to/repo]` または `[global]` を表示し、使用中のディレクトリモードを明示。

## [3.4.0] - 2026-02-23

### 追加機能
- **`[=]` Unchanged インジケータ**: 変換結果が既存ターゲットと同一のコマンド・スキルを `[M]` ではなく `[=]`（青）で表示し、ファイル書き込みをスキップ

### 修正
- **スキル変換: `_claude_` プレフィックスパターンの廃止**: スキルフィールドをコマンドと同様にそのままパススルーするように変更。ターゲットの frontmatter に `_claude_*` プレフィックス付きで保存する挙動を廃止。ロスレス変換は Chimera ハブで対応。コードの簡素化とコマンド変換との一貫性を実現。

## [3.2.0] - 2026-02-23

### 追加機能
- **`acs version` サブコマンド**: 現在のバージョン番号を表示

## [3.1.0] - 2026-02-23

### 追加機能
- **`acs status` サブコマンド**: Chimera ハブの状態を ASCII アート付きで表示
  - 進化するキメラ ASCII アート（Lv.0 の Ghost から10種の動物形態まで）
  - 検出エージェント、構成、コマンド/スキル件数を吹き出しで表示
  - Chimera ハブの `_chimera` フロントマターセクションをスキャンして同期済みエージェントを検出

## [3.0.0] - 2026-02-22

### 破壊的変更
- **CLI サブコマンドアーキテクチャ**: フラットな CLI オプションからサブコマンド方式に変更
  - `acs sync -s <src> -d <dest>` で直接変換
  - `acs import <agent>` は `acs sync -s <agent> -d chimera` の省略形
  - `acs drift <agent>` は `acs sync -s <agent> -d chimera -n` の省略形
  - `acs apply <agent>` は `acs sync -s chimera -d <agent>` の省略形
  - `acs plan <agent>` は `acs sync -s chimera -d <agent> -n` の省略形
- noop メッセージがサブコマンドに応じた表現に変更（例: `drift` では「Use `acs import` to apply changes」）

### 追加機能
- **Chimera Hub**: 全エージェント固有設定を `_chimera` フロントマターセクションに保持するロスレス変換ハブ
  - 任意のエージェントからのインポート時にエージェント別名前空間へ extras をマージ
  - 任意のエージェントへの適用時に保存された extras からエージェント固有設定を復元
  - コマンドとスキルの両方に対応
- **GitHub Copilot サポート**: 5番目のエージェント形式として追加（`.prompt.md` + YAML フロントマター）
- **Cursor サポート**: 6番目のエージェント形式として追加（プレーン Markdown、フロントマターなし）
- Chimera ハブワークフロードキュメント（`docs/chimera-hub-workflow.md`）

### 変更
- **Agent Registry パターン**: パーサー/コンバーターをエージェントごとに単一クラスへ統合
  - switch 文を型安全なレジストリルックアップに置換
  - レジストリからの動的 CLI オプション生成
- テストスイート拡充: 250 → 381 テスト

## [2.2.1] - 2026-02-21

### 修正
- README 画像に GitHub 絶対 URL を使用して npm 表示を修正
- publish 時の watch モード防止のため vitest に `--run` フラグを追加

## [2.2.0] - 2026-02-21

### 追加機能
- **Skills サポート**: Claude Code、Gemini CLI、Codex CLI 間でスキル（`SKILL.md` + サポートファイルのディレクトリ構造）の双方向変換を追加
  - サポートファイル処理（テキスト・バイナリファイルをそのままコピー）
  - Claude の `disable-model-invocation` から Codex の `agents/openai.yaml` を自動生成
  - `--sync-delete` による孤立スキルディレクトリの削除に対応
- **コンテンツタイプフィルタリング**: `-t, --type` オプションで `commands`、`skills`、`both`（デフォルト: `both`）を指定可能に

### 変更
- **SemanticIR ハブ&スポーク型アーキテクチャ**: 12個のペアワイズ変換器を6個の双方向 `SemanticConverter` に統合
  - ボディコンテンツを `BodySegment[]` としてトークン化し、IR レベルでプレースホルダー変換を実現
  - 型駆動の `PlaceholderSerializers` レジストリによるコンパイル時網羅性保証
  - Claude/Codex 共有ボディパターンを共通モジュールに集約
- **テストスイート拡充**: 182 → 250 テスト
  - Codex ボディ parse/serialize テスト、skill-utils テスト、writeToDirectory テストを追加
  - スキル変換・syncDelete 統合テストを追加
  - ファイル検索関数テストを追加
  - 無意味なプレースホルダーテストを削除

### 修正
- ドキュメントのシェルコマンド構文を `` !`command` `` に修正
- Biome lint が coverage ディレクトリを正しく除外するよう修正

## [2.1.0] - 2025-01-08

### 追加機能
- **ファイル参照変換**: Claude Code (`@path/to/file`) と Gemini CLI (`@{path/to/file}`) 間でファイル参照構文を自動変換する機能を追加
- **個別引数プレースホルダーのドキュメント化**: Claude Code と Codex CLI での `$1` から `$9` プレースホルダーのサポートをドキュメント化

### 変更
- README ドキュメントを改善し、より明確な形式比較表を作成
  - 「ファイル構造とメタデータ」と「コンテンツプレースホルダーと構文」セクションに分離
  - すべてのプレースホルダータイプに詳細な説明を追加

### 修正
- ファイル参照パターンが様々なファイルパスと拡張子を正しく処理するように修正

## [2.0.0] - 2025-01-07

### 破壊的変更
- パッケージ名を `agent-slash-sync` から `agent-command-sync` に変更
- コマンド名を `assync` から `acsync` に変更
- `-d, --dry-run` オプションを `-n, --noop` に変更
- `-c, --convert` オプションを削除し、`-s, --src` と `-d, --dest` で変換元と変換先を指定する方式に変更
- パッケージのURLが変更されました：
  - npm: `https://www.npmjs.com/package/agent-slash-sync` → `https://www.npmjs.com/package/agent-command-sync`
  - GitHub: `https://github.com/hatappo/agent-slash-sync` → `https://github.com/hatappo/agent-command-sync`

### 追加機能
- **Codex CLI サポート**: 3つ目のツール形式として Codex CLI をサポート
  - オプションのYAMLフロントマター付きマークダウンに対応
  - Claude Code、Gemini CLI、Codex CLI 間での双方向変換
  - `--remove-unsupported` が指定されていない場合はフロントマターを保持
- **中間表現（IR）アーキテクチャ**: 変換システムを完全に書き換え
  - 中間表現を介した集中化された変換ロジック
  - 将来的な新しいツール形式の追加が容易に
  - より保守しやすくテスト可能なコードベース

### 変更
- すべてのインラインコメントを日本語から英語に翻訳
- コードベース全体でエラーハンドリングとバリデーションを改善

### 依存関係
- すべての依存関係を最新バージョンに更新

## [1.2.0] - 前回のリリース
- `--claude-dir` と `--gemini-dir` オプションでカスタムベースディレクトリをサポート